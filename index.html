<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Optimizador Avanzado de APK (Cliente-Side)</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f0f2f5;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      color: #333;
    }
    .container {
      background: #fff;
      padding: 30px 40px;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      max-width: 600px;
      width: 100%;
      text-align: center;
      border: 1px solid #ddd;
    }
    h2 {
      color: #1a73e8;
      margin-bottom: 20px;
    }
    .upload-area {
      border: 2px dashed #1a73e8;
      padding: 40px 20px;
      border-radius: 8px;
      background: #f8f9fa;
      cursor: pointer;
      transition: background 0.3s;
    }
    .upload-area:hover {
      background: #e9f1ff;
    }
    .upload-area p {
      margin: 0;
      font-size: 18px;
      color: #555;
    }
    .upload-area span {
      font-size: 14px;
      color: #777;
    }
    input[type=file] {
      display: none;
    }
    button {
      padding: 12px 25px;
      font-size: 16px;
      border: none;
      background: #1a73e8;
      color: white;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 20px;
      transition: background 0.3s, box-shadow 0.3s;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    button:hover {
      background: #1865c9;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    }
    button:disabled {
      background: #ccc;
      cursor: not-allowed;
      box-shadow: none;
    }
    .output {
      margin-top: 25px;
      font-size: 15px;
      line-height: 1.6;
      text-align: left;
    }
    .status {
      padding: 10px;
      border-radius: 6px;
      margin-bottom: 10px;
    }
    .status.info { background-color: #e9f1ff; color: #1865c9; }
    .status.success { background-color: #e6f4ea; color: #1e8e3e; }
    .status.error { background-color: #fce8e6; color: #d93025; }
    .warning {
        background-color: #feefc3;
        color: #6d4f05;
        padding: 15px;
        border-radius: 8px;
        margin-top: 20px;
        font-size: 14px;
        border: 1px solid #f9ab00;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Optimizador de Recursos APK</h2>
    
    <div id="uploadArea" class="upload-area">
      <p>Arrastra y suelta tu archivo .apk aquí</p>
      <span>o haz clic para seleccionar un archivo</span>
    </div>
    <input type="file" id="apkFile" accept=".apk">
    
    <button id="compressBtn" disabled>Optimizar y Descargar (.zip)</button>
    
    <div class="output" id="output"></div>

    <div class="warning">
      <strong>Importante:</strong> Esta herramienta optimiza las imágenes dentro de tu APK y lo empaqueta como un archivo <strong>.zip</strong>. El resultado <strong>NO</strong> es un archivo .apk instalable. Para finalizar el proceso se requiere firmar y alinear el paquete con herramientas de desarrollo de Android.
    </div>
  </div>

  <!-- Librerías JS cargadas desde CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.11.0/jszip.min.js"></script>
  <!-- pngquant.js compilado a JS. Es grande porque es una herramienta potente. -->
  <script src="https://cdn.jsdelivr.net/gh/psych0der/pngquantjs/dist/pngquant.js"></script>

  <script>
    // Se envuelve todo en DOMContentLoaded para asegurar que el HTML y las librerías estén listos
    document.addEventListener('DOMContentLoaded', () => {
      const apkInput = document.getElementById('apkFile');
      const compressBtn = document.getElementById('compressBtn');
      const output = document.getElementById('output');
      const uploadArea = document.getElementById('uploadArea');

      let apkFile = null;

      // Funcionalidad de Drag and Drop
      uploadArea.addEventListener('click', () => apkInput.click());
      uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        e.stopPropagation();
        uploadArea.style.background = '#e9f1ff';
      });
      uploadArea.addEventListener('dragleave', (e) => {
        e.preventDefault();
        e.stopPropagation();
        uploadArea.style.background = '#f8f9fa';
      });
      uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        e.stopPropagation();
        uploadArea.style.background = '#f8f9fa';
        const files = e.dataTransfer.files;
        if (files.length > 0) {
          handleFile(files[0]);
        }
      });
      apkInput.addEventListener('change', e => handleFile(e.target.files[0]));

      function handleFile(file) {
        if (!file) return;

        const sizeMB = file.size / (1024 * 1024);
        if (sizeMB > 200) {
          log('APK demasiado grande. Máximo permitido: 200 MB.', 'error');
          compressBtn.disabled = true;
        } else if (!file.name.toLowerCase().endsWith('.apk')) {
          log('Por favor, selecciona un archivo .apk válido.', 'error');
          compressBtn.disabled = true;
        } else {
          log(`Archivo cargado: <strong>${file.name}</strong> (${sizeMB.toFixed(2)} MB). Listo para optimizar.`, 'success');
          apkFile = file;
          compressBtn.disabled = false;
        }
      }

      function log(message, type = 'info') {
          output.innerHTML = `<div class="status ${type}">${message}</div>` + (type !== 'info' ? output.innerHTML : '');
      }

      compressBtn.addEventListener('click', async () => {
        if (!apkFile) return;
        
        // **CORRECCIÓN:** Verificar si las librerías existen antes de usarlas
        if (typeof JSZip === 'undefined' || typeof pngquant === 'undefined') {
            log('Error: Las librerías externas no se cargaron correctamente. Revisa tu conexión a internet o posibles bloqueadores de scripts y recarga la página.', 'error');
            return;
        }

        compressBtn.disabled = true;
        output.innerHTML = ''; // Limpiar logs
        log('Iniciando proceso de optimización... ⏳');

        try {
          const originalZip = await JSZip.loadAsync(apkFile);
          const newZip = new JSZip();
          let optimizedImageCount = 0;
          let totalSavings = 0;

          const filesToProcess = Object.keys(originalZip.files);
          log(`Analizando ${filesToProcess.length} archivos dentro del APK...`);

          for (const filename of filesToProcess) {
            const file = originalZip.files[filename];
            
            if (!file.dir && filename.toLowerCase().endsWith('.png')) {
              const originalData = await file.async('uint8array');
              
              try {
                const optimizedData = pngquant(originalData);
                const savings = originalData.length - optimizedData.length;

                if (savings > 0) {
                    totalSavings += savings;
                    optimizedImageCount++;
                    newZip.file(filename, optimizedData);
                    console.log(`Optimizado: ${filename} (Ahorro: ${(savings/1024).toFixed(2)} KB)`);
                } else {
                    newZip.file(filename, originalData);
                }
              } catch(e) {
                  console.error(`No se pudo optimizar ${filename}: ${e}. Usando el original.`);
                  newZip.file(filename, await file.async('blob'));
              }
            } else {
              newZip.file(filename, await file.async('blob'));
            }
          }
          
          if(optimizedImageCount > 0) {
              log(`Optimización de imágenes completada. Se mejoraron <strong>${optimizedImageCount}</strong> imágenes con un ahorro total de <strong>${(totalSavings / (1024*1024)).toFixed(2)} MB</strong>.`, 'success');
          } else {
              log('No se encontraron imágenes PNG que pudieran ser optimizadas.', 'info');
          }

          log('Generando archivo .zip final...');
          const compressedBlob = await newZip.generateAsync({
            type: "blob",
            compression: "DEFLATE",
            compressionOptions: {
              level: 9
            }
          });

          const link = document.createElement('a');
          link.href = URL.createObjectURL(compressedBlob);
          link.download = apkFile.name.replace(/\.apk$/i, '_optimized.zip');
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          URL.revokeObjectURL(link.href);

          log(`¡Listo! El archivo <strong>${link.download}</strong> se está descargando. Tamaño final: <strong>${(compressedBlob.size/(1024*1024)).toFixed(2)} MB</strong>`, 'success');

        } catch (err) {
          log(`Error durante el proceso: ${err.message}`, 'error');
          console.error(err);
        } finally {
          compressBtn.disabled = false;
        }
      });
    });
  </script>
</body>
</html>      justify-content: space-between;
      margin-bottom: 10px;
    }
    .tab-button {
      flex: 1;
      padding: 10px;
      background: #333;
      color: white;
      border: none;
      cursor: pointer;
      user-select: none;
    }
    .tab-button.active { background: #555; }
    .tab-content { display: none; text-align: left; }
    .tab-content.active { display: block; }
    .checkbox-label { display: flex; align-items: center; margin: 8px 0; }
    .checkbox-label input[type=checkbox] {
      appearance: none; width: 20px; height: 20px;
      background: #444; border-radius: 4px; border: 2px solid #888; margin-right: 10px;
      cursor: pointer;
    }
    .checkbox-label input[type=checkbox]:checked { background: #888; }
    .precisao-container { display: flex; justify-content: space-between; align-items: center; margin-top: 15px; }
    input[type=range] { width: 100%; cursor: pointer; }
    select {
      margin-top: 10px;
      width: 100%;
      padding: 8px;
      background: #2a2a2f;
      color: #fff;
      border: 1px solid #555;
      border-radius: 5px;
      cursor: pointer;
    }
    .aimbot-options { display: flex; justify-content: space-between; margin-top: 15px; }
    .radio-label { display: flex; align-items: center; cursor: pointer; }
    input[type="radio"] {
      appearance: none; background-color: #444; border: 2px solid #888; border-radius: 50%;
      width: 18px; height: 18px; margin-right: 6px; position: relative; cursor: pointer;
    }
    input[type="radio"]:checked::before {
      content: ""; position: absolute; top: 3px; left: 3px; width: 8px; height: 8px; border-radius: 50%; background: #ccc;
    }
    .inject-btn, .login-btn {
      margin-top: 20px; padding: 10px; width: 100%; background-color: #202020;
      color: white; border: 2px solid white; border-radius: 5px; cursor: pointer; user-select: none; transition: background-color 0.2s ease;
    }
    .inject-btn:hover, .login-btn:hover { background-color: #444; }
    .profile-pic { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; margin-bottom: 10px; border: 2px solid #555; }
    .login-input {
      width: 100%; padding: 10px; margin-top: 10px; border-radius: 5px; border: 2px solid #444;
      background: #101015; color: white; font-size: 16px; text-align: center;
      outline-offset: 0; outline-color: transparent; transition: border-color 0.3s ease;
    }
    .login-input:focus { border-color: #888; outline-color: #888; }
    .social-links a {
      display: block; margin-top: 10px; background: #2a2a2f; padding: 10px; border-radius: 5px;
      text-decoration: none; color: white; user-select: none; transition: background-color 0.3s ease;
    }
    .social-links a:hover { background: #3a3a3f; }
    #color-picker { margin-top:10px; }
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/themes/classic.min.css"/>
</head>
<body>

<div id="particles-js"></div>

<div class="login-box" id="loginBox">
  <img src="https://files.fm/f/7nu5h4sqv6" alt="Foto de perfil" class="profile-pic" />
  <h2>Login com Key</h2>
  <input type="password" id="password" class="login-input" placeholder="Digite sua key de acesso" autocomplete="off" />
  <button class="login-btn" onclick="validarLogin()">Entrar</button>
  <div class="social-links">
    <a href="https://www.tiktok.com/@nyverxs.ios" target="_blank" rel="noopener noreferrer">TikTok Oficial</a>
  </div>
</div>

<div class="painel" id="painel">
  <h2>ESTAFAS</h2>
  <div class="tabs">
    <button class="tab-button active" onclick="openTab(event, 'aimbot')">Aimbot</button>
    <button class="tab-button" onclick="openTab(event, 'info')">Info</button>
    <button class="tab-button" onclick="openTab(event, 'misc')">MISC</button>
  </div>

  <div id="aimbot" class="tab-content active">
    <label class="checkbox-label"><input type="checkbox" /> Ativar Auxílio</label>
    <label class="checkbox-label"><input type="checkbox" /> Ativar Precisão</label>
    <div class="precisao-container">
      <input type="range" id="precisaoRange" min="0" max="100" value="10" oninput="document.getElementById('precisaoValue').innerText = this.value"/>
      <span style="margin-left: 10px;">Precisão <span id="precisaoValue">10</span></span>
    </div>
    <select>
      <option>Auxilio Head</option>
      <option>Auxilio Recoil</option>
      <option>Auxilio Sensi</option>
      <option>ESP linha</option>
    </select>
    <p style="margin-top: 20px;">Tipo de Aimbot:</p>
    <div class="aimbot-options">
      <label class="radio-label"><input type="radio" name="tipo" />Ao Atirar</label>
      <label class="radio-label"><input type="radio" name="tipo" />Ao Olhar</label>
    </div>
    <button class="inject-btn" onclick="redirecionarParaJogo()">INJETAR FUNÇÕES NO JOGO</button>
  </div>

  <div id="info" class="tab-content">
    <p>Painel criado por DEV (@RYZEN STORE & @PECINHA DEV).</p>
    <p>Versão 2.114.X.</p>
    <p><strong>Tempo restante da Key:</strong></p>
    <p id="tempoRestante" style="font-size: 18px; color: #0f0;">Carregando...</p>
  </div>

  <div id="misc" class="tab-content">
    <p>Mudar cor do painel:</p>
    <div id="color-picker"></div>
    <div id="preview" style="width:40px;height:40px;margin-top:10px;border:2px solid #fff;border-radius:5px;"></div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/pickr.min.js"></script>
<script>
  const keyList = { "DRAKE-day":5,"WAZE-week":7,"DRAKE-month":5 };
  const linkDoJogo = "https://ff.garena.com/";

  function redirecionarParaJogo(){ window.open(linkDoJogo,"_blank"); }

  window.onload = () => {
    mostrarPainel();
    atualizarContagem();
  };

  function validarLogin() {
    mostrarPainel();
  }

  function mostrarPainel(){ 
    document.getElementById("loginBox").style.display="none"; 
    document.getElementById("painel").style.display="block"; 
  }

  function limparKey(){ 
    localStorage.removeItem("key_ativa"); 
    localStorage.removeItem("key_expira_em"); 
    document.getElementById("painel").style.display="none"; 
    document.getElementById("loginBox").style.display="block"; 
    document.getElementById("password").value=""; 
  }

  function openTab(evt, tabId){ 
    document.querySelectorAll('.tab-content').forEach(el=>el.classList.remove('active')); 
    document.querySelectorAll('.tab-button').forEach(el=>el.classList.remove('active')); 
    document.getElementById(tabId).classList.add('active'); 
    evt.currentTarget.classList.add('active'); 
  }

  function atualizarContagem(){ 
    const tempoRestante=document.getElementById("tempoRestante"); 
    if(tempoRestante) {
      tempoRestante.innerText="Acesso Permanente";
      tempoRestante.style.color = "#00ff00";
    }
  }

  particlesJS('particles-js',{ particles:{ number:{ value:90 }, color:{ value:"#0000FF" }, shape:{ type:"circle" }, opacity:{ value:0.4 }, size:{ value:3 }, line_linked:{ enable:true,distance:200,color:"#ffffff",opacity:0.5,width:1 }, move:{ enable:true,speed:3 } }, interactivity:{ detect_on:"canvas",events:{ onhover:{ enable:true,mode:"grab" },onclick:{ enable:false } } }, retina_detect:true });

  const pickr = Pickr.create({
    el: '#color-picker',
    theme: 'classic',
    default: '#1a1a1f',
    swatches: ['#1a1a1f','#0a0a0f','#ff0000','#00ff00','#0000ff','#ffff00','#00ffff','#ff00ff'],
    components: { preview:true, opacity:true, hue:true, interaction:{ hex:true, rgba:true, input:true, save:true } }
  });

  const painel = document.querySelector('.painel');
  const preview = document.getElementById('preview');

  pickr.on('change', color => {
    const c = color.toHEXA().toString();
    painel.style.background = c;
    preview.style.background = c;
  });
</script>

</body>
        </html>
